{% extends "base.html" %}

{% block title %}File Comparison{% endblock %}

{% block content %}
<div class="container">
    <div class="sidebar">
        <h2>프로젝트</h2>
        <span id="file1-name" class="file-name"></span>
        <div class="structure-container" id="original-structure-container">
            <!-- Original file structure will be displayed here -->
        </div>
    </div>
    <div class="main-content">
        <h1>파일 비교</h1>
        <button id="save-changes-btn" class="action-btn">변경사항 저장</button>
        <input type="text" id="filename-suffix" placeholder="Input File name">
        <div id="result-message" class="result-message"></div>
        <div class="results">
            <div class="column content-column">
                <div class="title-section">
                    <h3>원본 파일 내용</h3>
                </div>
                <div class="upload-section">
                    <input type="file" name="file1" id="file1" class="file-input" style="display: none;" required>
                    <button type="button" class="open-file-btn" onclick="document.getElementById('file1').click();">Open File.zip</button>
                </div>
                <div class="file-content" id="original-file-content">
                    <!-- Original file content will be displayed here -->
                </div>
            </div>
            <div class="column content-column">
                <div class="title-section">
                    <h3>변경 파일 내용</h3>
                </div>
                <div class="upload-section">
                    <input type="file" name="file2" id="file2" class="file-input" style="display: none;" required>
                    <button type="button" class="open-file-btn" onclick="document.getElementById('file2').click();">Open File</button>
                    <span id="file2-name" class="file-name"></span>
                </div>
                <div class="file-content" id="changed-file-content">
                    <!-- Changed file content will be displayed here -->
                </div>
            </div>
        </div>
        <div class="compare-section">
            <button id="compare-btn" class="action-btn">코드 차이점</button>
            <div class="comparison-result" id="comparison-result">
                <!-- Differences will be displayed here -->
            </div>
            <button id="review-btn" class="action-btn">AI 코드 리뷰</button>
            <div id="review-result">
                <!-- Review feedback will be displayed here -->
            </div>
        </div>

        <!-- 댓글 섹션 -->
        <div id="comment-section">
            <h2>댓글</h2>
            <form id="comment-form">
                <input type="text" id="username" placeholder="Your Name" class="input-field" required>
                <textarea id="user-comment" placeholder="Your Comment" class="textarea-field" required></textarea>
                <input type="hidden" id="page" value="home">
                <button id="submit-btn" type="submit" class="submit-btn">작성</button>
            </form>
            <div id="comments-list">
                {% for comment in comments %}
                <div class="comment">
                    <p><strong>{{ comment.username }}</strong>: {{ comment.user_comment }}</p>
                    {% if comment.admin_response %}
                    <p><em>Admin:</em> {{ comment.admin_response }}</p>
                    {% elif current_user.is_authenticated and current_user.is_admin %}
                    <form class="response-form" data-id="{{ comment.id }}">
                        <textarea placeholder="Admin Response" class="textarea-field"></textarea>
                        <button type="submit" class="submit-btn">쓰기</button>
                    </form>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
<script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
<script src="{{ url_for('static', filename='js/comments.js') }}"></script>
<script src="{{ url_for('static', filename='js/files.js') }}"></script>
{% endblock %}
